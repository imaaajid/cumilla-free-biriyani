<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cumilla Biriyani Tracker | Ultimate Pro</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

<style>
body{font-family:'Hind Siliguri',sans-serif;overflow-x:hidden;}
#preloader{position:fixed;inset:0;background:#fff;z-index:9999;
display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;}
.dark #preloader{background:#111827;color:white;}
.fade-quote{opacity:0;transition:opacity 1s;}
.fade-quote.show{opacity:1;}
.progress{height:6px;border-radius:20px;}
.admin-badge{position:fixed;top:70px;right:10px;background:red;color:white;
padding:5px 10px;border-radius:20px;font-size:11px;z-index:999;}
</style>
</head>

<body class="bg-orange-50 dark:bg-gray-900 dark:text-gray-100">

<div id="preloader">
<lottie-player src="https://assets2.lottiefiles.com/packages/lf20_m6cuL6.json"
background="transparent" speed="1" style="width:180px;" loop autoplay></lottie-player>
<p class="mt-4 font-bold text-orange-600" id="preloader-text">рж▓рзЛржб рж╣ржЪрзНржЫрзЗ...</p>
</div>

<div id="adminBadge" class="admin-badge hidden">ADMIN MODE</div>

<div class="bg-stone-900 text-white py-3 px-4 flex justify-between">
<div id="countdown" class="text-xs font-bold text-orange-400">ржЗржлрждрж╛рж░рзЗрж░ ржмрж╛ржХрж┐: --:--:--</div>
<button onclick="toggleDarkMode()" class="text-orange-400">
<i id="dark-icon" class="fa-solid fa-moon"></i></button>
</div>

<header class="text-center py-6 bg-white shadow">
<h1 class="text-2xl font-black text-orange-600">CUMILLA BIRIYANI ЁЯНЦ</h1>
<div class="text-xs mt-2 font-bold">
<span id="active-count">0</span> ржЯрж┐ рж▓рж╛ржЗржн рж▓рзЛржХрзЗрж╢ржи
</div>
</header>

<main id="post-container" class="max-w-md mx-auto px-4 mt-6 space-y-6 pb-32"></main>

<div id="quoteBox"
class="fixed bottom-20 left-1/2 -translate-x-1/2 bg-white px-6 py-3 rounded-xl shadow-lg fade-quote z-50 text-sm font-semibold text-center"></div>

<script>

// ===== ADMIN SYSTEM =====
const ADMIN_SECRET="biriyaniadmin2026";
const urlParams=new URLSearchParams(window.location.search);
const isAdmin=urlParams.get("admin")===ADMIN_SECRET;
if(isAdmin){document.getElementById("adminBadge").classList.remove("hidden");}

// ===== DATABASE =====
const DB_URL="https://cumilla-biriyani-default-rtdb.asia-southeast1.firebasedatabase.app/posts.json";

// ===== FETCH AUTO REFRESH =====
setInterval(fetchData,4000);

async function fetchData(){
const res=await fetch(DB_URL);
const data=await res.json();
const posts=data?Object.keys(data).map(id=>({id,...data[id]})).reverse():[];
renderUI(posts);
}

function renderUI(posts){
const container=document.getElementById("post-container");
container.innerHTML="";
document.getElementById("active-count").innerText=posts.length;

posts.forEach(post=>{
const total=(post.true_count||0)+(post.fake_count||0);
const percent=total?Math.round((post.true_count||0)/total*100):0;
const verified=(post.true_count||0)>=5;

container.innerHTML+=`
<div class="bg-white p-6 rounded-3xl shadow relative">

${isAdmin?`
<div class="absolute top-3 right-3 flex gap-2 text-xs">
<button onclick="editPost('${post.id}')" class="bg-blue-500 text-white px-2 py-1 rounded">тЬП</button>
<button onclick="deletePost('${post.id}')" class="bg-red-500 text-white px-2 py-1 rounded">ЁЯЧС</button>
<button onclick="resetVotes('${post.id}')" class="bg-yellow-500 text-white px-2 py-1 rounded">ЁЯФД</button>
</div>`:""}

<h3 class="text-xl font-black mb-2">
ЁЯУН ${post.location}
${verified?'<span class="text-blue-500 text-sm ml-2">тЬФ Verified</span>':''}
</h3>

<p class="text-sm text-gray-500 mb-3">${post.description||''}</p>

<div class="w-full bg-gray-200 rounded-full mb-3">
<div class="bg-green-500 progress" style="width:${percent}%"></div>
</div>

<div class="flex gap-2">
<button onclick="vote('${post.id}','true_count')"
class="flex-1 bg-green-100 py-2 rounded-xl text-xs font-bold">
тЬЕ рж╕рждрзНржпрж┐ (${post.true_count||0})
</button>
<button onclick="vote('${post.id}','fake_count')"
class="flex-1 bg-red-100 py-2 rounded-xl text-xs font-bold">
тЭМ ржорж┐ржерзНржпрж╛ (${post.fake_count||0})
</button>
</div>

</div>`;
});
}

// ===== ONE VOTE =====
async function vote(id,type){
let voted=JSON.parse(localStorage.getItem("votes")||"{}");
if(voted[id]){alert("ржЖржкржирж┐ ржЗрждрж┐ржоржзрзНржпрзЗ ржнрзЛржЯ ржжрж┐рзЯрзЗржЫрзЗржи!");return;}

const res=await fetch(DB_URL.replace(".json","")+"/"+id+".json");
const post=await res.json();
const update={};
update[type]=(post[type]||0)+1;

await fetch(DB_URL.replace(".json","")+"/"+id+".json",
{method:"PATCH",body:JSON.stringify(update)});

voted[id]=true;
localStorage.setItem("votes",JSON.stringify(voted));
fetchData();
}

// ===== ADMIN FUNCTIONS =====
async function deletePost(id){
if(!confirm("ржбрж┐рж▓рж┐ржЯ ржХрж░ржмрзЗржи?"))return;
await fetch(DB_URL.replace(".json","")+"/"+id+".json",{method:"DELETE"});
fetchData();
}
async function resetVotes(id){
if(!confirm("ржнрзЛржЯ рж░рж┐рж╕рзЗржЯ ржХрж░ржмрзЗржи?"))return;
await fetch(DB_URL.replace(".json","")+"/"+id+".json",
{method:"PATCH",body:JSON.stringify({true_count:0,fake_count:0})});
fetchData();
}
async function editPost(id){
const newName=prompt("ржирждрзБржи рж▓рзЛржХрзЗрж╢ржи ржирж╛ржо:");
const newDesc=prompt("ржирждрзБржи ржмрж░рзНржгржирж╛:");
if(!newName)return;
await fetch(DB_URL.replace(".json","")+"/"+id+".json",
{method:"PATCH",body:JSON.stringify({location:newName,description:newDesc})});
fetchData();
}

// ===== DARK MODE =====
function toggleDarkMode(){
document.documentElement.classList.toggle("dark");
document.getElementById("dark-icon").className=
document.documentElement.classList.contains("dark")?
"fa-solid fa-sun":"fa-solid fa-moon";
}

// ===== COUNTDOWN =====
setInterval(()=>{
const now=new Date();
const iftar=new Date();iftar.setHours(18,15,0);
if(now>iftar)iftar.setDate(iftar.getDate()+1);
const diff=iftar-now;
const h=Math.floor(diff/3600000);
const m=Math.floor((diff%3600000)/60000);
const s=Math.floor((diff%60000)/1000);
document.getElementById("countdown").innerText=
`ржЗржлрждрж╛рж░рзЗрж░ ржмрж╛ржХрж┐: ${h}:${m}:${s}`;
},1000);

// ===== ISLAMIC QUOTES =====
const islamicQuotes=[
"рж╕рж╛ржмрж░ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржирж┐ржХржЯ ржорж░рзНржпрж╛ржжрж╛рж░ред","ржпрж╛рж░рж╛ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржкржерзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ, рждрж╛рж░рж╛ ржзржирзНржпред","ржкрзНрж░рж╛рж░рзНржержирж╛ ржУ ржнрж╛рж▓рзЛ ржХрж╛ржЬрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржмрж░ржХржд ржЖрж╕рзЗред",
"рж░рзЛржЬрж╛ ржзрзИрж░рзНржп ржУ ржирж┐рзЯржирзНрждрзНрж░ржг рж╢рзЗржЦрж╛рзЯред","рж╕рзБржирзНржжрж░ ржЖржЪрж░ржг ржЖрж▓рзНрж▓рж╛рж╣рж░ ржкрзНрж░рж┐ржпрж╝ред","ржпрзЗ ржХрзЗржЙ ржЕржирзНржпрзЗрж░ ржЬржирзНржп ржЙржкржХрж╛рж░рзА рж╣ржпрж╝, рж╕рзЗ ржзржирзНржпред",
"ржкрзНрж░рждрзНржпрзЗржХ ржЗржлрждрж╛рж░ ржЖрж▓рзНрж▓рж╛рж╣рж░ рж░рж╣ржорждрзЗрж░ рж╕рзНржорзГрждрж┐ред","рж░рзЛржЬрж╛рж░ рж╕ржоржпрж╝ рж╕рзО ржУ ржирзНржпрж╛ржпрзНржп ржЖржЪрж░ржг ржЕржкрж░рж┐рж╣рж╛рж░рзНржпред","ржлрзНрж░рж┐ ржЗржлрждрж╛рж░ ржмрж┐рждрж░ржг ржХрж░рж╛ржЗ рж╕ржУржпрж╝рж╛ржмред",
"ржЖрж▓рзНрж▓рж╛рж╣рж░ ржирж┐ржХржЯ рж╣рж╛рж▓рж╛рж▓ ржЦрж╛ржУржпрж╝рж╛ ржмрж░ржХржд ржмрзГржжрзНржзрж┐ ржХрж░рзЗред","ржпрзЗ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржирж╛ржо ржирж┐ржпрж╝рзЗ ржЦрж╛ржпрж╝, рждрж╛рж░ ржЦрж╛ржмрж╛рж░рзЗ ржмрж░ржХржд ржерж╛ржХрзЗред","рж░рзЛржЬрж╛ ржЖрждрзНржорж╢рзБржжрзНржзрж┐ ржУ ржирж┐рзЯржирзНрждрзНрж░ржг рж╢рзЗржЦрж╛ржпрж╝ред",
"ржжрж░рж┐ржжрзНрж░ржХрзЗ ржЦрж╛ржУржпрж╝рж╛ржирзЛ ржорж╣рж╛ржи ржЖржорж▓ред","ржкрзНрж░рждрзНржпрзЗржХ ржЗржлрждрж╛рж░ ржПржХржЯрж┐ ржжрж╛ржиред","ржЖрж▓рзНрж▓рж╛рж╣рж░ ржЬржирзНржп рж╕рж╛рж╣рж╛ржпрзНржп ржУ ржжрж╛ржи ржмрж░ржХржд ржЖржирзЗред",
"рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рж╛ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржирж┐ржХржЯ ржкрзНрж░рж┐ржпрж╝ред","рж░рзЛржЬрж╛ ржХрзНрж╖рзБржзрж╛ рж╕рж╣рзНржп ржХрж░рждрзЗ рж╢рзЗржЦрж╛ржпрж╝ред","ржнрж╛рж▓рзЛ ржХрж╛ржЬ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржХрж╛ржЫрзЗ ржЧрзНрж░рж╣ржгржпрзЛржЧрзНржпред",
"рж░рзЛржЬрж╛ ржзрзИрж░рзНржп, ржиржорзНрж░рждрж╛ ржУ ржзрзНржпрж╛ржи рж╢рзЗржЦрж╛ржпрж╝ред","ржЖрж▓рзНрж▓рж╛рж╣рж░ ржЬржирзНржп ржжрзЗржУржпрж╝рж╛ ржкрзНрж░рждрж┐ржЯрж┐ ржЦрж╛ржмрж╛рж░ рж╕ржУржпрж╝рж╛ржмред"
];

let qi=0;
const quoteBox=document.getElementById("quoteBox");
function showQuote(){
quoteBox.classList.remove("show");
setTimeout(()=>{
quoteBox.innerText=islamicQuotes[qi];
quoteBox.classList.add("show");
qi=(qi+1)%islamicQuotes.length;
},500);
}
showQuote();
setInterval(showQuote,30000);

// ===== PRELOADER MESSAGES =====
const preloaderMsgs=[
"ржмрж┐рж░рж┐ржпрж╝рж╛ржирж┐ рж░рж╛рж╕рзНрждрж╛ ржЦрзБржБржЬржЫрзЗтАж ЁЯНЦ","ржЗржлрждрж╛рж░ ржЕржнрж┐ржпрж╛ржи рж╢рзБрж░рзБ рж╣ржЪрзНржЫрзЗтАж ЁЯП╣ЁЯМЩ","ржЖржкржирж╛рж░ ржХрзНрж╖рзБржзрж╛ рж░рзЗржбрж┐ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗтАж ЁЯШЛ",
"ржХрж╛ржЪрзНржЪрж┐ ржУ рждрзЗрж╣рж╛рж░рж┐ ржЖржкржбрзЗржЯ рж╣ржЪрзНржЫрзЗтАж ЁЯНЧ","рж▓рж╛ржЗржн рж╕рзНржкржЯ ржорзНржпрж╛ржк ржорзНржпрж╛ржЬрж┐ржХ ржЪрж▓ржЫрзЗтАж тЬи","ржирждрзБржи ржмрж┐рж░рж┐ржпрж╝рж╛ржирж┐ ржкрзЯрзЗржирзНржЯ рж╕рж╛рж░рзНржЪрж┐ржВтАж ЁЯФН",
"ржмрж┐рж░рж┐ржпрж╝рж╛ржирж┐ рж╣рж╛ржирзНржЯрж┐ржВ ржорзЛржб ржЕржитАж ЁЯХ╡я╕ПтАНтЩВя╕П","ржЪрж╛ржкрж╛ ржжрж╛ржУ, ржЗржлрждрж╛рж░ рж╕рзНржкржЯ рж▓рзЛржб рж╣ржЪрзНржЫрзЗтАж ЁЯЪА","ржлрзНрж░рж┐ ржмрж┐рж░рж┐ржпрж╝рж╛ржирж┐ ржЖржкржбрзЗржЯ ржЖржиржЫрзЗтАж ЁЯОБ",
"ржЧрж░ржо ржЧрж░ржо ржмрж┐рж░рж┐ржпрж╝рж╛ржирж┐ ржарж┐ржХ ржЖржкржирж╛рж░ ржХрж╛ржЫрзЗтАж ЁЯФеЁЯНЫ"
];
document.getElementById("preloader-text").innerText=
preloaderMsgs[Math.floor(Math.random()*preloaderMsgs.length)];

window.addEventListener("load",()=>{
setTimeout(()=>{document.getElementById("preloader").style.display="none";},800);
});

fetchData();
</script>
</body>
</html>
